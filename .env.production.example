# =============================================================================
# CONFIGURACIÓN DE PRODUCCIÓN - AZURE APP SERVICE
# Proyecto: Asistente Plantitas
# =============================================================================

# Este archivo es un EJEMPLO de las variables de entorno necesarias para
# producción en Azure App Service. NO contiene valores reales.
# 
# Para configurar en Azure:
# 1. Ve a Azure Portal → Tu App Service → Settings → Configuration
# 2. En "Application settings", agrega cada variable con su valor real
# 3. NO subas este archivo con valores reales al repositorio

# =============================================================================
# BASE DE DATOS - MySQL Azure
# =============================================================================

# Connection string completa para MySQL en Azure
# Formato: mysql+pymysql://usuario:password@servidor.mysql.database.azure.com:3306/nombre_bd?ssl_ca=/etc/ssl/certs/ca-certificates.crt
DATABASE_URL=mysql+pymysql://plantitasadmin:TU_PASSWORD_AQUI@plantitas-demo-mysql.mysql.database.azure.com:3306/plantitas_db?ssl_ca=/etc/ssl/certs/ca-certificates.crt

# Configuración de pool de conexiones (opcional)
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_ECHO=false

# =============================================================================
# SEGURIDAD Y AUTENTICACIÓN
# =============================================================================

# JWT Secret Key - DEBE ser un string aleatorio de 64+ caracteres
# Generar con: python -c "import secrets; print(secrets.token_urlsafe(64))"
JWT_SECRET_KEY=CAMBIAR_POR_SECRET_ALEATORIO_64_CARACTERES_MINIMO

# Algoritmo de JWT (dejar como está)
JWT_ALGORITHM=HS256

# Tiempo de expiración del token de acceso (en minutos)
JWT_EXPIRACION_MINUTOS=30

# Tiempo de expiración del refresh token (en días)
JWT_REFRESH_EXPIRACION_DIAS=7

# Número de rondas de bcrypt para hash de passwords
BCRYPT_ROUNDS=12

# =============================================================================
# AZURE BLOB STORAGE
# =============================================================================

# Connection string de Azure Storage Account
# Obtener desde: Azure Portal → Storage Account → Access Keys
AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=plantitasdemostorage;AccountKey=TU_ACCOUNT_KEY_AQUI;EndpointSuffix=core.windows.net

# Nombre del container para imágenes
AZURE_STORAGE_CONTAINER_NAME=plantitas-imagenes

# Usar emulador Azurite (false para producción)
AZURE_STORAGE_USE_EMULATOR=false

# Account name (alternativa a connection string)
# AZURE_STORAGE_ACCOUNT_NAME=plantitasdemostorage

# Account key (alternativa a connection string)
# AZURE_STORAGE_ACCOUNT_KEY=TU_ACCOUNT_KEY_AQUI

# =============================================================================
# CORS - Control de Acceso
# =============================================================================

# URLs permitidas para CORS (JSON array de strings)
# Incluir la URL del frontend de Azure App Service
ORIGENES_CORS=["https://plantitas-demo-frontend.azurewebsites.net","https://plantitas-demo-backend.azurewebsites.net"]

# Permitir credenciales (cookies, authorization headers)
CORS_ALLOW_CREDENTIALS=true

# Métodos HTTP permitidos (JSON array)
CORS_ALLOW_METHODS=["GET","POST","PUT","DELETE","PATCH","OPTIONS"]

# Headers permitidos (JSON array o "*" para todos)
CORS_ALLOW_HEADERS=["*"]

# =============================================================================
# ENTORNO Y CONFIGURACIÓN GENERAL
# =============================================================================

# Entorno de ejecución
ENTORNO=produccion

# Debug mode (SIEMPRE false en producción)
DEBUG=false

# Nivel de log (INFO para producción, DEBUG para troubleshooting)
NIVEL_LOG=INFO

# Formato de logs
LOG_FORMATO="%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# =============================================================================
# CONFIGURACIÓN DEL SERVIDOR
# =============================================================================

# Host (0.0.0.0 para escuchar en todas las interfaces)
HOST=0.0.0.0

# Puerto (8000 por defecto para App Service)
PUERTO=8000

# Número de workers (1 para Free tier F1)
WORKERS=1

# =============================================================================
# UPLOADS Y ARCHIVOS
# =============================================================================

# Directorio temporal para uploads (antes de subir a Blob Storage)
DIRECTORIO_UPLOADS=./uploads

# Tamaño máximo de archivo en MB
MAX_TAMANO_ARCHIVO_MB=10

# Formatos de imagen permitidos (JSON array)
FORMATOS_IMAGEN_PERMITIDOS=["jpg","jpeg","png","webp"]

# =============================================================================
# APIs EXTERNAS - GOOGLE GEMINI
# =============================================================================

# Google Gemini API Key
# Obtener desde: https://makersuite.google.com/app/apikey
GEMINI_API_KEY=TU_GEMINI_API_KEY_AQUI

# Modelo de Gemini a usar
GEMINI_MODEL=gemini-1.5-flash

# Límites de uso
GEMINI_MAX_REQUESTS_PER_DAY=1500
GEMINI_MAX_REQUESTS_PER_USER_PER_DAY=50

# Temperatura para generación (0.0 - 1.0)
GEMINI_TEMPERATURE=0.7

# Máximo de tokens en la respuesta
GEMINI_MAX_OUTPUT_TOKENS=8192

# Timeout para requests (segundos)
GEMINI_TIMEOUT_SECONDS=30

# =============================================================================
# APIS EXTERNAS - PLANTNET (Opcional)
# =============================================================================

# PlantNet API Key (si se implementa en el futuro)
# PLANTNET_API_KEY=TU_PLANTNET_API_KEY_AQUI
# PLANTNET_API_URL=https://my-api.plantnet.org/v2/identify
# PLANTNET_PROJECT=all
# PLANTNET_MAX_REQUESTS_PER_DAY=500

# =============================================================================
# RATE LIMITING Y PAGINACIÓN
# =============================================================================

# Número máximo de requests por minuto por IP
RATE_LIMIT_POR_MINUTO=60

# Tamaño por defecto de página para paginación
PAGINACION_TAMANO_DEFECTO=20

# Tamaño máximo de página
PAGINACION_TAMANO_MAXIMO=100

# =============================================================================
# FRONTEND (Para Azure App Service del Frontend)
# =============================================================================

# URL del backend API
# Esta variable la usa el frontend Next.js
NEXT_PUBLIC_API_URL=https://plantitas-demo-backend.azurewebsites.net

# URL interna del backend (dentro de Azure, si están en la misma región)
# Opcional: para comunicación interna más rápida
# INTERNAL_API_URL=http://plantitas-demo-backend.azurewebsites.net

# Entorno de Node.js
NODE_ENV=production

# =============================================================================
# MONITOREO Y OBSERVABILIDAD (Opcional)
# =============================================================================

# Application Insights Connection String (si se configura)
# APPLICATIONINSIGHTS_CONNECTION_STRING=InstrumentationKey=tu-key-aqui

# =============================================================================
# NOTAS IMPORTANTES
# =============================================================================

# 1. SEGURIDAD:
#    - Nunca subas este archivo con valores reales al repositorio
#    - Usa Azure Key Vault para secretos críticos en producción
#    - Rota las API keys periódicamente
#
# 2. VARIABLES REQUERIDAS (mínimo para funcionar):
#    - DATABASE_URL
#    - JWT_SECRET_KEY
#    - AZURE_STORAGE_CONNECTION_STRING
#    - GEMINI_API_KEY
#    - ORIGENES_CORS
#    - NEXT_PUBLIC_API_URL (para frontend)
#
# 3. CONFIGURACIÓN EN AZURE APP SERVICE:
#    - Azure Portal → App Service → Configuration → Application settings
#    - Cada variable se configura como "Name" y "Value"
#    - Marcar como "Slot setting" si usas deployment slots
#    - Click "Save" después de agregar todas las variables
#
# 4. TESTING:
#    - Usa valores de prueba en staging/development
#    - Verifica cada variable después de configurar
#    - Revisa logs de App Service para errores
#
# 5. BACKUP:
#    - Guarda una copia de estas configuraciones en lugar seguro
#    - Documenta cambios de configuración
#    - Usa Azure CLI para exportar/importar settings si es necesario
